Refactor this become more generic